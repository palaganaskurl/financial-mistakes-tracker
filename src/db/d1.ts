import { drizzle } from "drizzle-orm/d1";

export interface Env {
  FINANCIAL_MISTAKES_TRACKER_D1: D1Database;
  FINANCIAL_MISTAKES_TRACKER_D1_DEV: D1Database;
}

export default {
  async fetch(request: Request, env: Env) {
    const db = env.FINANCIAL_MISTAKES_TRACKER_D1
      ? drizzle(env.FINANCIAL_MISTAKES_TRACKER_D1)
      : drizzle(env.FINANCIAL_MISTAKES_TRACKER_D1_DEV);
    const result = await db.select().from(users).all();

    return Response.json(result);
  },
};
